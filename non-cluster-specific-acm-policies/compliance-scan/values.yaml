---
apply_auto_remediations: false

node:
  - type: master
    name: basic-scan
    enable_scan_setting: true
    selector: |-
      node-role.kubernetes.io/master: ''
    tolerations:
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
      operator: Exists
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    - effect: NoSchedule
      key: node.kubernetes.io/memory-pressure
      operator: Exists
    scan_profile:
      - name: ocp4-cis
      - name: ocp4-cis-node

  - type: infra
    name: basic-scan
    enable_scan_setting: true
    selector: |-
      node-role.kubernetes.io/cluster-infra: ''
    tolerations:
      - key: node-role.kubernetes.io/infra
        operator: Equal
        value: "true"
        effect: NoSchedule
      - key: node-role.kubernetes.io/infra
        operator: Equal
        value: "true"
        effect: NoExecute
    scan_profile:
      - name: ocp4-cis
      - name: ocp4-cis-node

  - type: odf
    name: basic-scan
    enable_scan_setting: true
    selector: |-
      node-role.kubernetes.io/odf: ''
    tolerations:
    - key: node.ocs.openshift.io/storage
      operator: Equal
      value: 'true'
      effect: NoSchedule
    - key: node.kubernetes.io/unreachable
      operator: Exists
      effect: NoExecute
      tolerationSeconds: 5
    - key: node.kubernetes.io/not-ready
      operator: Exists
      effect: NoExecute
      tolerationSeconds: 300
    - key: node.kubernetes.io/memory-pressure
      operator: Exists
      effect: NoSchedule
    scan_profile:
      - name: ocp4-cis
      - name: ocp4-cis-node

  - type: app
    name: basic-scan
    enable_scan_setting: true
    selector: |-
      node-role.kubernetes.io/app: ''
    scan_profile:
      - name: ocp4-cis
      - name: ocp4-cis-node
